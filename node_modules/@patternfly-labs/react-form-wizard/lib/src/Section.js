import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { DescriptionList, Divider, Split, SplitItem, Stack, Text, Title } from '@patternfly/react-core';
import { AngleDownIcon, AngleLeftIcon, ExclamationCircleIcon } from '@patternfly/react-icons';
import { Fragment, useEffect, useState } from 'react';
import { LabelHelp } from './components/LabelHelp';
import { DisplayMode, useDisplayMode } from './contexts/DisplayModeContext';
import { HasInputsContext, HasInputsProvider, useSetHasInputs } from './contexts/HasInputsProvider';
import { HasValueContext, HasValueProvider } from './contexts/HasValueProvider';
import { useShowValidation } from './contexts/ShowValidationProvider';
import { HasValidationErrorContext, ValidationProvider } from './contexts/ValidationProvider';
import { useInputHidden } from './inputs/Input';
export function Section(props) {
    return _jsx(SectionInternal, { ...props }, void 0);
}
function SectionInternal(props) {
    const mode = useDisplayMode();
    const id = props.id ?? props.label?.toLowerCase().split(' ').join('-') ?? '';
    const showValidation = useShowValidation();
    const [expanded, setExpanded] = useState(props.defaultExpanded === undefined ? true : props.defaultExpanded);
    const hidden = useInputHidden(props);
    const setHasInputs = useSetHasInputs();
    useEffect(() => {
        if (props.autohide === false)
            setHasInputs();
    }, [setHasInputs, props.autohide]);
    if (hidden)
        return _jsx(Fragment, {}, void 0);
    if (mode === DisplayMode.Details)
        return (_jsx(HasValueProvider, { children: _jsx(HasValueContext.Consumer, { children: (hasValue) => hasValue ? (_jsxs(Fragment, { children: [_jsx(Title, { headingLevel: "h2", children: props.label }, void 0), _jsx(DescriptionList, { id: id, isHorizontal: true, isCompact: true, style: { paddingLeft: 16, paddingBottom: 16, paddingRight: 16 }, children: props.children }, void 0)] }, void 0)) : (_jsx("div", { style: { display: 'none' }, children: props.children }, void 0)) }, void 0) }, id));
    return (_jsx(HasInputsProvider, { children: _jsx(HasInputsContext.Consumer, { children: (hasInputs) => (_jsx(ValidationProvider, { children: _jsx(HasValidationErrorContext.Consumer, { children: (hasValidationError) => (_jsxs("section", { id: id, className: "pf-c-form__section", role: "group", style: { display: !hasInputs && props.autohide !== false ? 'none' : undefined }, children: [_jsxs(Split, { hasGutter: true, onClick: () => {
                                    if (props.collapsable)
                                        setExpanded(!expanded);
                                }, children: [_jsx(SplitItem, { isFilled: true, children: _jsxs(Stack, { children: [_jsxs(Split, { hasGutter: true, children: [_jsx("span", { className: "pf-c-form__section-title", children: props.label }, void 0), props.id && (_jsx(LabelHelp, { id: props.id, labelHelp: props.labelHelp, labelHelpTitle: props.labelHelpTitle }, void 0))] }, void 0), expanded && props.description && (_jsx(Text, { component: "small", style: { paddingTop: 8 }, children: props.description }, void 0))] }, void 0) }, void 0), showValidation && !expanded && hasValidationError && (_jsx(SplitItem, { children: _jsxs(Split, { children: [_jsx(SplitItem, { children: _jsx(ExclamationCircleIcon, { color: "var(--pf-global--danger-color--100)" }, void 0) }, void 0), _jsx(SplitItem, { children: _jsx("span", { className: "pf-c-form__helper-text pf-m-error", children: "\u00A0 Expand to fix validation errors" }, void 0) }, void 0)] }, void 0) }, void 0)), props.collapsable &&
                                        (expanded ? (_jsx(SplitItem, { children: _jsx("div", { style: { marginBottom: -5 }, children: _jsx(AngleDownIcon, {}, void 0) }, void 0) }, void 0)) : (_jsx(SplitItem, { children: _jsx("div", { style: { marginBottom: -5 }, children: _jsx(AngleLeftIcon, {}, void 0) }, void 0) }, void 0)))] }, void 0), expanded ? props.children : _jsx("div", { style: { display: 'none' }, children: props.children }, void 0), !expanded && _jsx(Divider, {}, void 0)] }, void 0)) }, void 0) }, void 0)) }, void 0) }, id));
}
//# sourceMappingURL=Section.js.map